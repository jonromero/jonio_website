<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" type="text/css" href="../theme/css/style.css"> 
    <link rel="stylesheet" type="text/css" href="../theme/css/pygments.css">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:800,400,300|Inconsolata' rel='stylesheet' type='text/css'>
	<link href="http://jon.io/" type="application/atom+xml" rel="alternate" title="Jon.IO ATOM Feed" />


        <title>Jon.IO - Articles by Jon V <h2>BigData. Startups. Trading.</h2></title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Jon V <h2>BigData. Startups. Trading.</h2>">
<script src="//load.sumome.com/" data-sumo-site-id="fee114a4f556c3310f466abe1eb7a9bab628c1b53aa6dac75200d0af9af9c330" async="async"></script>
</head>

<body>
    <section id="navbar">
        <div class="user_meta">
            <h1 id="user"><a href=".." class="">Jon V <h2>BigData. Startups. Trading.</h2></a></h1>
            <h2></h2>
        </div>
        <div class="nav-button">
            <ul>
                            <li><a href="http://twitter.com/jonromero">Twitter</a></li>
                            <li><a href="http://www.linkedin.com/in/johnvlachoyiannis">LinkedIn</a></li>
                            <li><a href="http://github.com/jonromero/">Github</a></li>
                            <li><a href="http://bitbucket.org/jonromero/">Bitbucket</a></li>
             </ul>
         </div>
     </section>

     <section id="sidebar">
        <div class="user_meta">
            <h1 id="user"><a href=".." class="">Jon V <h2>BigData. Startups. Trading.</h2></a></h1>
            <h2></h2>
            <ul>
                        <li><a href="http://twitter.com/jonromero">Twitter</a></li>
                        <li><a href="http://www.linkedin.com/in/johnvlachoyiannis">LinkedIn</a></li>
                        <li><a href="http://github.com/jonromero/">Github</a></li>
                        <li><a href="http://bitbucket.org/jonromero/">Bitbucket</a></li>
            </ul>
        </div>
        <footer>
            <address>
                Powered by <a href='http://docs.getpelican.com/en/latest/'>Pelican</a>,
                <a href='https://github.com/jamescooke/pelican-svbtle#readme'>theme info</a>.
            </address>
        </footer>
    </section>

    <section id="posts">
	
        <article class='listed'>
            <h1 class="title">
                <a href="../why-the-irs-loves-forex.html" rel='bookmark'>Why the IRS loves Forex</a>
            </h1>
            <div class="article-content"> <p><em>This is the another post of the series: <a href="how-to-build-your-own-algorithmic-trading-platform.html">How to build your own algotrading platform</a>.</em></p>
<p><em>Update: The Machine Learning post is going to be epic but it takes so much time to make the code presentable. Bear with me, cool things are coming (as you've read at the <a href="http://eepurl.com/bGbOnb">newsletter</a>)</em></p>
<p>Disclaimer: <strong>THIS IS NOT TAX ADVICE.</strong></p>
<p>What is really surprising is that the majority of the requests in the newsletter are:</p>
<ol>
<li>Use tools to assist Trading</li>
<li>Machine Learning to optimize trades</li>
<li>Taxes</li>
</ol>
<p>The first two, I can understand. Everybody wants to be a better trader. I get it. But taxes? TAXES? </p>
<p>This is your lucky day. Forex taxes are super easy. Seriously. By default (this is called <em>Section 988</em>), all your losses are going to offset your income taxes without the 3k limit per year. This is much better than stock trading where losses offset your capital gains.</p>
<p>But what happens to gains? <strong>WHY DO YOU CARE? WHY?</strong> <a href="building-a-backtesting-system-in-python-or-how-i-lost-3400-in-two-hours.html">The majority of the Forex traders lose money</a> (I call it "paying tuition") the first year(s), so you are better off keeping it simple until you have a proven and consistent strategy (and an architecture that scales).</p>
<p>Having said that, if you actually make a profit, you are taxed at the short-term capital gain (sometimes up to 40%).
The solutions to when you start making money are:</p>
<ol>
<li>Opting out of Section 988 and get taxed under Section 1256 where 60% of profits are taxed as long term capital gains and 40% as short term (but now losses cannot offset your income). This is very good when you make money, very bad when you don't.</li>
<li>Start an LLC</li>
</ol>
<p>For people that just started experimenting with Forex and algotrading, I always suggest them to stay with Section 988 (the default) and when they start making some money (consistently) or they want to go full time, talk to me :) Seriously, there are so many things that you will start doing differently when you go from the "hobby" stage to "second income" to "full-time job" that there is no reason to over-optimize this. </p>
<p>Coming up next: Machine Learning Gone Wild!</p>
<p>If you have more feedback, ping me at <a href="http://www.twitter.com/jonromero">jonromero</a> or signup to the <a href="http://eepurl.com/bGbOnb">newsletter</a>. </p>
<p>Legal outro. This is an engineering tutorial on how to build an algotrading platform for experimentation and FUN. Any suggestions here are not financial advices. 
If you lose any (or all) you money because you followed any trading advices or deployed this system in production, you cannot blame this random blog (and/or me). Enjoy at your own risk. </p> </div>
            <div class="abbr published">
                Posted  <a href='../why-the-irs-loves-forex.html' title='2016-04-01T22:30:00-07:00'>Fri 01 April 2016</a> in <a href="../category/trading.html">trading</a>.              
            </div>
        </article>
        <article class='listed'>
            <h1 class="title">
                <a href="../you-dont-need-to-be-a-scientist-to-build-a-backtesting-algotrading-system-in-python.html" rel='bookmark'>You don't need to be a scientist to build a backtesting algotrading system in Python</a>
            </h1>
            <div class="article-content"> <p>Building the simplest backtesting system in Python
Tags: algotrading
Date: 2016-02-01 22:30</p>
<p><em>This is the another post of the series: <a href="how-to-build-your-own-algorithmic-trading-platform.html">How to build your own algotrading platform</a>.</em></p>
<p>Last time we talked about <a href="building-a-backtesting-system-in-python-or-how-i-lost-3400-in-two-hours.html">The "for-looper" backtester</a> (as I love to call them). Now it's time to see some code!</p>
<p>We said that we have something like that:</p>
<p>:::python
    for each element of readhistoricaldata(): 
        apply_strategy() 
        how_our_strategy_did()</p>
<p>Sweet, let's load our strategy, load some <a href="downloading-historical-forex-tick-data-and-importing-them-in-to-python-using-pandas.html">historical</a> data, run our algorithm and print some results!</p>
<script src="https://gist.github.com/jonromero/72428f085a41ddf85259.js"></script>

<p>I prefer to have my strategies in a JSON format that contains the name of the strategy and some specs (like how many pips for stop_loss or take_profit etc). That way, when we'll start using an event-based backtester, we can pass the strategy through a machine learning algorithm and try to optimize it.</p>
<p>Next line is loading our data in. I know people don't like pickle and there other ways to load data (and we are going to talk about BColz at some point) but for now, just bare with me.</p>
<p>The next line is self-explanatory. We pass the historical data to our algo and we get back some stats to print.</p>
<p>Let's focus on the algorithm a little bit and we can discuss plotting etc at a later point.</p>
<p><em>The magic of the simple backtesting system</em></p>
<p>Prepare to be amazed by how ridiculously easy to do this.</p>
<script src="https://gist.github.com/jonromero/7792e71e9079f75ce9a5.js"></script>

<p><em>Short comings</em>
What happens with this type of backtesting is that 
1. <a href="building-a-backtesting-system-in-python-or-how-i-lost-3400-in-two-hours.html">you'll probably make mistakes when you want to using the exact same algorithm</a>
2. You won't be able to write a very complex strategy (at least that easy)
3. Very difficult to scale (compared to event-based)
4. You need to have your simulation and execution in the same language</p>
<p>BUT remember that this is the BEST and fastest way to start out and figure out how all these things work. </p>
<p>Coming up next, using other well-known backtesters in Python and adding graphs to our own!</p>
<p>If you have more feedback, ping me at <a href="http://www.twitter.com/jonromero">jonromero</a> or signup to the <a href="http://eepurl.com/bGbOnb">newsletter</a>. </p>
<p>Legal outro. This is an engineering tutorial on how to build an algotrading platform for experimentation and FUN. Any suggestions here are not financial advices. 
If you lose any (or all) you money because you followed any trading advices or deployed this system in production, you cannot blame this random blog (and/or me). Enjoy at your own risk. </p> </div>
            <div class="abbr published">
                Posted  <a href='../you-dont-need-to-be-a-scientist-to-build-a-backtesting-algotrading-system-in-python.html' title='2016-04-01T14:17:47-07:00'>Fri 01 April 2016</a> in <a href="../category/trading.html">trading</a>.              
            </div>
        </article>
        <article class='listed'>
            <h1 class="title">
                <a href="../strategies-for-forex-and-trading.html" rel='bookmark'>Strategies for Forex and trading</a>
            </h1>
            <div class="article-content"> <p><em>This is the another post of the series: <a href="how-to-build-your-own-algorithmic-trading-platform.html">How to build your own algotrading platform</a>.</em></p>
<p>What is a good algotrading system without some neat strategies to deploy?</p>
<p>Below there is a list of strategies that I found online (or sent to me by traders that are on the <a href="http://eepurl.com/bGbOnb">newsletter</a>). I plan to update the list as I keep coming across to new ideas.</p>
<p>The concept is that as we keep diving more and more into our algotrading system, I will show you how to code and deploy these strategies. I know for sure that most of them work with minimal changes. Worst case scenario, you'll have a system to test out your assumptions.   </p>
<p>Here is the list (and please send me any other strategy that you think it should be included):</p>
<p>Coming up next, sharing and discussing my simplest (but most successful) backtester!</p>
<p>If you have more feedback, ping me at <a href="http://www.twitter.com/jonromero">jonromero</a> or signup to the <a href="http://eepurl.com/bGbOnb">newsletter</a>. </p>
<p>Legal outro. This is an engineering tutorial on how to build an algotrading platform for experimentation and FUN. Any suggestions here are not financial advices. 
If you lose any (or all) you money because you followed any trading advices or deployed this system in production, you cannot blame this random blog (and/or me). Enjoy at your own risk. </p> </div>
            <div class="abbr published">
                Posted  <a href='../strategies-for-forex-and-trading.html' title='2015-12-28T22:13:00-08:00'>Mon 28 December 2015</a> in <a href="../category/trading.html">trading</a>.              
            </div>
        </article>
        <article class='listed'>
            <h1 class="title">
                <a href="../building-a-backtesting-system-in-python-or-how-i-lost-3400-in-two-hours.html" rel='bookmark'>Building a backtesting system in Python: or how I lost $3400 in two hours</a>
            </h1>
            <div class="article-content"> <p><em>This is the another post of the series: <a href="how-to-build-your-own-algorithmic-trading-platform.html">How to build your own algotrading platform</a>.</em></p>
<p>Building a backtest system is actually pretty easy. Easy to screw up I mean. Even though there are tons of excellent libraries out there (and we'll go through them at some point), I always like doing this on my own in order to fine-tune it.</p>
<p>From all the backtesting systems I have seen, we can assume that there are two categories:</p>
<ol>
<li>The "for-loopers"</li>
<li>The Event generators</li>
</ol>
<p>Today, we'll talk about for-loopers.</p>
<p>The "for-loopers" are my favorite type of backtesters. They are trivial to write and super fun to expand but they have some vital flows and sadly the majority of backtesters out there is "for-loopers" (ps: I need to find a better name for this!).</p>
<p>How for-loopers work? Using a for loop (as you might have guessed). It is something like this:</p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">each</span> <span class="n">element</span> <span class="n">of</span> <span class="n">readhistoricaldata</span><span class="p">():</span> 
    <span class="n">apply_strategy</span><span class="p">()</span> 
    <span class="n">how_our_strategy_did</span><span class="p">()</span>
</pre></div>


<p>Very simple right? This is how one backtesting system works, that runs a momentum strategy:</p>
<script src="https://gist.github.com/jonromero/125cbca28067f0aefb2c.js"></script>

<p>So, what is the problem? </p>
<ol>
<li>Very difficult to scale (horizontally) </li>
<li>Needs lots of work to keep your apply_strategy() working on backtesting and production </li>
<li>You need to have everything in the same programming language</li>
</ol>
<p>Let's dive into these, one by one.</p>
<p><em>Scalability</em>. 
I was experimenting a couple a weeks ago with a <a href="https://en.wikipedia.org/wiki/Hill_climbing">hill-climbing</a> algorithm to optimize one of my strategies. It is still running. After two weeks. And I build uber-scalable systems for a living.
Why is it still running? You can use <a href="https://docs.python.org/2/library/multiprocessing.html">multiprocessing</a>, <a href="http://discoproject.org/">Disco</a>, producer/consumer (using <a href="http://zeromq.org/">ZeroMQ</a>) or just threads to speed this up but some problems are not "<a href="https://en.wikipedia.org/wiki/Embarrassingly_parallel">embarrassing parallel</a>" (yes, this is an actual term, not one of my made-up words). The amount of work to scale a backtester like this (especially when you want to do same machine learning on top of it) is huge. You can do it but it is the wrong way.</p>
<p><em>Production and backtesting in sync</em>
This. The times I have been bitten by this. I can recall the lost trades where I was "hm, why I entered this trade?" or my old time favorite "WHY TRAILING STOP WAS APPLIED NOW?".</p>
<p>Story time: I had an idea in order to optimize my strategy, to run a backtester to see what would happen if I could put a trailing stop AFTER the trade was profitable in order to always secure profits. Backtesting worked like a charm at a 13% increase of earnings and <em>production lost every single trade</em>. I figured it out after my algo lost $3400 in a couple of hours (a very expensive lesson).</p>
<p>Keeping the apply_strategy in sync is very difficult and becomes almost impossible when you want to do it in a distributed fashion. And you don't want to have two version of your strategy that are "almost" identical. Unless you have $3400 to spare.</p>
<p><em>Using different languages</em>
I love Python. And Erlang. And Clojure. And J. And C. And R. And Ruby (no actually I hate Ruby). I want to be able to leverage the strength of other languages in my system. I want to try out strategies in R where there are very well-tested libraries and there is a huge community behind it. I want to have Erlang to scale my code and C to crunch data. If you want to be succesful (not only in trading), you need to be able to use all the available resources without prejudices. I have learnt tons of stuff from hanging out with R developers regarding how you can delta hedge bonds and visualize them or why Sharpe ratio can be a lie. Every language has a different crowd and you want as many people pouring ideas into your system.
If you try to have apply_strategy in different language then good luck with (2).</p>
<p>Are you convinced now? Well, I am not trying to convince you as for-loopers is a great way to run your initial tests. It is how I started and for many strategies I don't send them down to the pipeline. A "better" way (so you can sleep at night) is the event generators.</p>
<p>Coming up next, sharing and discussing my simplest (but most successful) backtester!</p>
<p>If you have more feedback, ping me at <a href="http://www.twitter.com/jonromero">jonromero</a> or signup to the <a href="http://eepurl.com/bGbOnb">newsletter</a>. </p>
<p>Legal outro. This is an engineering tutorial on how to build an algotrading platform for experimentation and FUN. Any suggestions here are not financial advices. 
If you lose any (or all) you money because you followed any trading advices or deployed this system in production, you cannot blame this random blog (and/or me). Enjoy at your own risk. </p> </div>
            <div class="abbr published">
                Posted  <a href='../building-a-backtesting-system-in-python-or-how-i-lost-3400-in-two-hours.html' title='2015-12-13T22:48:00-08:00'>Sun 13 December 2015</a> in <a href="../category/trading.html">trading</a>.              
            </div>
        </article>
        <article class='listed'>
            <h1 class="title">
                <a href="../downloading-historical-forex-tick-data-and-importing-them-in-to-python-using-pandas.html" rel='bookmark'>Downloading historical Forex tick data and importing them in to Python using Pandas</a>
            </h1>
            <div class="article-content"> <p><em>This is the another post of the series: <a href="how-to-build-your-own-algorithmic-trading-platform.html">How to build your own algotrading platform</a>.</em></p>
<p>Before running any live algotrading system, it is a good practice to backtest (that means run a simulation) our algorithms. Have in mind that this doesn't mean that if your system is killing it for the last 5 years/months/days it will make a profit but it is a good indicator that you might be on to something.</p>
<p>There are four things that we need to take into consideration when we do our backtesting:</p>
<ol>
<li>The quality of the data</li>
<li>How to load them efficiently </li>
<li>How to built our backtesting system</li>
<li>Try to have our backtesting and our live system share as much code as we can</li>
</ol>
<p>Today, we are going to focus on (1) and (2).</p>
<p>For Forex data, I am using <a href="http://ratedata.gaincapital.com/">GainCapital</a>. Their data are in the form of <a href="http://www.investopedia.com/terms/t/tick.asp">ticks</a>. For a free source it is good enough. I used to use Oanda's historical data service but it seems that they moved it to a premium product. Too bad. Make sure that you use GainCapital's data only for experimentation.</p>
<p>For any other kind of paid historical data (ETFs, stocks, options stc), I am using <a href="http://eoddata.com/">eoddata.com</a> (they also have some forex historical data but I haven't used them).</p>
<p>Let's download data for a week and experiment a little bit.
The link to the data is <a href="http://ratedata.gaincapital.com/2015/11%20November/EUR_USD_Week1.zip">http://ratedata.gaincapital.com/2015/11%20November/EUR_USD_Week1.zip</a> for the first week of November 2015.</p>
<p>First we need to unzip the file
    :::python
    &gt;unzip EUR_USD_Week1.zip</p>
<p>and you'll get a <em>25MB</em> file named EUR_USD_Week1.csv. These are data for one week for one currency pair. You can imagine the amount of data you need to process for all currencies for the last five years (hint: a lot!). But don't worry, we are going optimize this. For now, let's open the file and inspect.</p>
<div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="n">head</span> <span class="n">EUR_USD_Week1</span><span class="o">.</span><span class="n">csv</span>
</pre></div>


<table>
<thead>
<tr>
<th>lTid</th>
<th>cDealable</th>
<th>CurrencyPair</th>
<th>RateDateTime</th>
<th>RateBid</th>
<th>RateAsk</th>
</tr>
</thead>
<tbody>
<tr>
<td>4464650058</td>
<td>D</td>
<td>EUR/USD</td>
<td>2015-11-01 17:00:06.490000000</td>
<td>1.103380</td>
<td>1.103770</td>
</tr>
<tr>
<td>4464650061</td>
<td>D</td>
<td>EUR/USD</td>
<td>2015-11-01 17:00:06.740000000</td>
<td>1.103400</td>
<td>1.103760</td>
</tr>
<tr>
<td>4464650072</td>
<td>D</td>
<td>EUR/USD</td>
<td>2015-11-01 17:00:07.990000000</td>
<td>1.103390</td>
<td>1.103750</td>
</tr>
<tr>
<td>4464650083</td>
<td>D</td>
<td>EUR/USD</td>
<td>2015-11-01 17:00:08.990000000</td>
<td>1.103400</td>
<td>1.103750</td>
</tr>
</tbody>
</table>
<p>the things that we care about is the RateDateTime, RateBid and RateAsk. As you can understade each line has a timestamp and the how much was the price to buy or sell. Formats downloaded by other services are pretty similar.</p>
<p>There are many ways to load these data into Python but the most preferable when it comes to data slicing and manipulating is using <a href="http://pandas.pydata.org/">Pandas</a>.
We can always use the <a href="https://docs.python.org/2/library/csv.html">csv</a> library to load data (and it might be faster) but we need to do some optimizations and processing first that as you will see it is pretty easy with pandas. </p>
<p>Another great tool to load TONS of GBs pretty efficiently and very fast is using <a href="http://bcolz.blosc.org/">Bcolz</a>, covered in a much later post (or you can read a preview if you have signed up in the <a href="http://eepurl.com/bGbOnb">newsletter</a>.</p>
<p><em>Manipulating data using Pandas</em>
The data we downloaded are in ticks. Unless we are building an UHFT (ultra high frequency trading) algorithm, it is much more efficient (memory, storage and processing-wise) to
"group" these ticks into seconds (or minutes or hours depending on your strategy). This will make our download scale down from 25MB to just <em>35KB</em> which translate to HUGE performance and memory benefits.</p>
<p>Let's group all these data in 15 minutes. How? Time to fall in love with resample.</p>
<div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;DateTime&#39;</span><span class="p">},</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;DateTime&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Tid&#39;</span><span class="p">,</span> <span class="s1">&#39;Dealable&#39;</span><span class="p">,</span> <span class="s1">&#39;Pair&#39;</span><span class="p">,</span> <span class="s1">&#39;DateTime&#39;</span><span class="p">,</span> <span class="s1">&#39;Buy&#39;</span><span class="p">,</span> <span class="s1">&#39;Sell&#39;</span><span class="p">],</span> <span class="n">date_parser</span><span class="o">=</span><span class="n">parse</span><span class="p">)</span>

<span class="c1"># let&#39;s erase the columns we don&#39;t need</span>
<span class="k">del</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Tid&#39;</span><span class="p">]</span> 
<span class="k">del</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dealable&#39;</span><span class="p">]</span>
<span class="k">del</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Pair&#39;</span><span class="p">]</span>

<span class="c1"># group every 15 minutes and create an OHLC bar</span>
<span class="n">grouped_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;15Min&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;ohlc&#39;</span><span class="p">)</span>
</pre></div>


<p>The resampled the dataset looks like this:</p>
<table>
<thead>
<tr>
<th>DateTime</th>
<th>Buy</th>
<th>Open</th>
<th>Buy</th>
<th>High</th>
<th>Buy</th>
<th>Low</th>
<th>Buy</th>
<th>Close</th>
</tr>
</thead>
<tbody>
<tr>
<td>2015-08-02 17:00:00</td>
<td>1.09706</td>
<td>1.09821</td>
<td>1.09706</td>
<td>1.09735</td>
<td>1.09752</td>
<td>1.09853</td>
<td>1.09740</td>
<td>1.09762</td>
</tr>
<tr>
<td>2015-08-02 17:15:00</td>
<td>1.09731</td>
<td>1.09825</td>
<td>1.09731</td>
<td>1.09769</td>
<td>1.09762</td>
<td>1.09843</td>
<td>1.09758</td>
<td>1.09808</td>
</tr>
</tbody>
</table>
<p>This is called OHLC (Open High Low Close) bar for every <em>15 minutes</em>. You can see now that the ticks are grouped in 15 minute segments and you have the highest and lowest point that the price reached during these 15 minutes and also the open/close for buy and sell. Pure gold! Not only you have all the information you need but now it is extremely fast to load it. You just need to save the data:</p>
<div class="highlight"><pre><span></span><span class="p">::</span> <span class="n">python</span>
<span class="c1"># save to file</span>
<span class="n">grouped_data</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;-OHLC.pkl&#39;</span><span class="p">)</span>
</pre></div>


<p>and then you can reuse this 35kb file. </p>
<p>We can write a simple momentum algorithm that checks if there was a huge movement the last 15 minutes and if that was the case, let's buy. We will dive into this in a later post.</p>
<p>You can see the code as always on <a href="https://github.com/jonromero/forex_algotrading/blob/master/post4/create_OHLC.py">github</a>.</p>
<p>Coming up next, <a href="http://jon.io/building-a-backtesting-system-in-python-or-how-i-lost-3400-in-two-hours.html">building a backtesting system from scratch</a>!</p>
<p>If you have more feedback, ping me at <a href="http://www.twitter.com/jonromero">jonromero</a> or signup to the <a href="http://eepurl.com/bGbOnb">newsletter</a>. </p>
<p>Legal outro. This is an engineering tutorial on how to build an algotrading platform for experimentation and FUN. Any suggestions here are not financial advices. 
If you lose any (or all) you money because you followed any trading advices or deployed this system in production, you cannot blame this random blog (and/or me). Enjoy at your own risk. </p> </div>
            <div class="abbr published">
                Posted  <a href='../downloading-historical-forex-tick-data-and-importing-them-in-to-python-using-pandas.html' title='2015-12-03T22:48:00-08:00'>Thu 03 December 2015</a> in <a href="../category/trading.html">trading</a>.              
            </div>
        </article>
        <article class='listed'>
            <h1 class="title">
                <a href="../placing-your-first-forex-trade-with-python.html" rel='bookmark'>Placing your first Forex trade with Python</a>
            </h1>
            <div class="article-content"> <p>Time to talk about brokers, how to place a trade programmatically and most importantly how not to get scammed.</p>
<p>This is the third part of the series: <a href="how-to-build-your-own-algorithmic-trading-platform.html">How to build your own algotrading platform</a>.</p>
<p>A broker is nothing more than a company that lets you trade (buy or sell) assets on a market through their platform. What is very important for algotrading is: </p>
<ol>
<li>The broker offers an API in order for us to place orders</li>
<li>You can have a demo account to run your staging environment and experiment</li>
<li>The spread is as small as possible</li>
</ol>
<p>In our case, we don't really care about spread as we won't be doing High Frequency Trading any time soon.</p>
<p>Even though brokers are regulated, there have been incidents in the past couple of years, were brokers folded due to certain conditions. Be <em>very</em> wary if </p>
<ol>
<li>There are no reviews of the broker on the internet (or most of them are bad)</li>
<li>If the broker offers you some crazy leverage (like 1:200)</li>
<li>If the broker seems to be in a very strange country</li>
</ol>
<p>What could happen is that you start making some money and you aren't be able to pull them out. Seriously. Super stressful situation.</p>
<p>But let's switch to a happier note which is opening an account and placing our first programmatic trade. Whooha!</p>
<p>I am using <a href="http://www.oanda.com/">Oanda</a> as a broker (I am not affiliated with them) and they offer a pretty decent API, libraries on github and a free demo account. </p>
<p>Go and open a free <a href="https://fxtrade.oanda.com/your_account/fxtrade/register/gate">fxTrade Practice account</a>.</p>
<p>After you get your free demo account, go to your profile 
<img src="https://dl.dropboxusercontent.com/u/757245/jonio/oanda.png" /></p>
<p>and you can change your leverage (switch it to 50:1) and then go back to your <strong>Manage API Access</strong>. There you can find your API key which we are going to use in our system to place trades. <strong>MAKE SURE YOU DON'T SHARE THIS KEY</strong>.</p>
<p>The code for this is and all other posts is on my <a href="https://github.com/jonromero/Forex-algotrading">github</a> and you can install it and run it pretty easily.</p>
<p>The code is straight-forward. We connect to Oanda, to a practice account with our token </p>
<div class="highlight"><pre><span></span><span class="n">oanda</span> <span class="o">=</span> <span class="n">oandapy</span><span class="o">.</span><span class="n">API</span><span class="p">(</span><span class="n">environment</span><span class="o">=</span><span class="s2">&quot;practice&quot;</span><span class="p">,</span>
                   <span class="n">access_token</span><span class="o">=</span><span class="n">OANDA_ACCESS_TOKEN</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">oanda</span><span class="o">.</span><span class="n">get_prices</span><span class="p">(</span><span class="n">instruments</span><span class="o">=</span><span class="s2">&quot;EUR_USD&quot;</span><span class="p">)</span>
<span class="n">prices</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;prices&quot;</span><span class="p">)</span>
<span class="n">buy_price</span> <span class="o">=</span> <span class="n">prices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bid&quot;</span><span class="p">)</span>
</pre></div>


<p>and we are requesting the prices (bid/ask) for the pair EUR_USD. </p>
<p>We print the buy price and then we place a <em>market</em> order. </p>
<div class="highlight"><pre><span></span><span class="k">print</span> <span class="s2">&quot;Buy at&quot;</span><span class="p">,</span> <span class="n">buy_price</span>
<span class="n">trade_id</span> <span class="o">=</span> <span class="n">oanda</span><span class="o">.</span><span class="n">create_order</span><span class="p">(</span><span class="n">OANDA_ACCOUNT_ID</span><span class="p">,</span><span class="n">instrument</span><span class="o">=</span><span class="s2">&quot;EUR_USD&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                  <span class="n">side</span><span class="o">=</span><span class="s1">&#39;buy&#39;</span><span class="p">,</span>
                  <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;market&#39;</span><span class="p">)</span>
</pre></div>


<p>Super easy. Don't worry about what EURUSD is or how many units we are buying or what a market order is. For now, we have placed our first trade from our laptop and we are going to build our own API to place trades. Exciting stuff!</p>
<p>You can read Oanda's documentation <a href="http://developer.oanda.com/">here</a> to see what else you can do with their API.</p>
<p>Coming up next, connecting to a real <strong>LIVE</strong> algotrading system, running from my RaspberryPI at home. </p>
<p><img src="https://dl.dropboxusercontent.com/u/757245/jonio/trades-nov.jpg" /></p>
<p>You'll be able to see the (almost) final program running and we'll talk more about Forex and strategies. </p>
<p>If you have more feedback, ping me at <a href="http://www.twitter.com/jonromero">jonromero</a> or signup to the <a href="http://eepurl.com/bGbOnb">newsletter</a>. </p>
<p>Legal outro. This is an engineering tutorial on how to build an algotrading platform for experimentation and FUN. Any suggestions here are not financial advices. 
If you lose any (or all) you money because you followed any trading advices or deployed this system in production, you cannot blame this random blog (and/or me). Enjoy at your own risk. </p> </div>
            <div class="abbr published">
                Posted  <a href='../placing-your-first-forex-trade-with-python.html' title='2015-10-20T22:48:00-07:00'>Tue 20 October 2015</a> in <a href="../category/trading.html">trading</a>.              
            </div>
        </article>
        <article class='listed'>
            <h1 class="title">
                <a href="../what-is-forex.html" rel='bookmark'>What is Forex</a>
            </h1>
            <div class="article-content"> <p>This is the second part of the series: <a href="how-to-build-your-own-algorithmic-trading-platform.html">How to build your own algotrading platform</a>.</p>
<p>Before building any algotrading systems, you need to know how to trade manually. What that actually means is that you need to lose money on your own before blaming the machine. As simple as that.</p>
<p>So, let's talk about Foreign Exchange or Forex as the cool guys call it.</p>
<p>First of all, why do we choose Forex for algotrading? Why don't we become millionaires trading like everybody else? Why not just buy Tesla, Amazon, Google, Facebook, Twitter and hope for the best (PS: please read the legal outro at the end of this blog post before buying any stocks).</p>
<p>Easy answer. You cannot win (or lose) money fast enough by buying stocks.</p>
<p>Forex has a nice (or terrible, depending on which side of the coin you are) thing called <em>leverage</em>. </p>
<p>Leverage can be 1:10, 1:50, 1:100, 1:200, 1:1000 depending on how suicidal you are or how sketchy your broker is (don't worry, we'll talk about brokers in the next post). Let's see an example.</p>
<p>We want to place a trade of $1k. The logical thing is that in order to buy something that costs $1k, you need to have in your account $1k, right? Nope. You can always get a loan. Oooooooor: Enter leverage.</p>
<p>If we have a 1:100 leverage, we can place a trade and "control" $1k with just $10. For those that failed at math (don't be ashamed, I am one of you), $10 x 100 (leverage) = $1,000.
That means you can trade big and win big! Actually 100 times more <em>big</em>! The catch is that you can actually go 100 times more <em>small</em>. Let's have another example.</p>
<p>I just got my bonus ($1k) and I want to play on Forex.
Without any leverage, I can buy 1,000 Forex units that cost $1 (by the way, there are no Forex units but we'll talk about this later). 
How many units can I buy with 1:50 leverage?</p>
<p>If you answer if 100,000, you did something wrong. The answer is 50,000 ($1,000 x 50 leverage). </p>
<p>There you have it. One of the reasons that we are doing Forex, is because you can <a href="http://jon.io/building-a-backtesting-system-in-python-or-how-i-lost-3400-in-two-hours.html">lose</a>/win big. We'll get back to leverage when we start placing trades.</p>
<p>There are three more exciting reasons actually that are even more awesome (dare to say awesomer?).</p>
<ol>
<li>Forex (almost) never sleeps. The markets are open ALL DAY, six days per week. To be more exact, there is not one market but four and they are overlapping providing the "all day" effect.</li>
<li>Forex is very volatile and there are tons of money moving around (more than 5 trillion <em>per day</em>). Crazy right? </li>
<li>No fees on trades. You don't pay $10 per trade like you are doing with stocks. Here you pay <em>the spread</em> which is just a fraction of a cent (again, we'll talk about this in another post).</li>
</ol>
<p>All these reasons (leverage, all-day, volatility, fees) make Forex the most exciting platform to build and deploy your algorithms. </p>
<p>Coming up next, Forex brokers. How not to be scammed before even writing a line of code.</p>
<p>If you have more feedback, ping me at <a href="http://www.twitter.com/jonromero">jonromero</a> or signup to the <a href="http://eepurl.com/bGbOnb">newsletter</a>. </p>
<p>Legal outro. This is an engineering tutorial on how to build an algotrading platform for experimentation and FUN. Any suggestions here are not financial advices. 
If you lose any (or all) you money because you followed any trading advices or deployed this system in production, you cannot blame this random blog (and/or me). Enjoy at your own risk. </p> </div>
            <div class="abbr published">
                Posted  <a href='../what-is-forex.html' title='2015-10-12T22:48:00-07:00'>Mon 12 October 2015</a> in <a href="../category/trading.html">trading</a>.              
            </div>
        </article>
        <article class='listed'>
            <h1 class="title">
                <a href="../how-to-build-your-own-algorithmic-trading-platform-part-one.html" rel='bookmark'>How to build your own algorithmic trading platform - Part One</a>
            </h1>
            <div class="article-content"> <p>That's it. Every week, I get at least 10 DMs on twitter asking on how to experiment with algotrading, Forex and portfolio analysis and I've decided that it's time to do something about it.</p>
<p>Update: Find the posts <a href="how-to-build-your-own-algorithmic-trading-platform.html">here</a>.</p>
<p>So, I am planning to cover the basics of how to build your own trading platform, write your own strategies and go on vacations while electrons are making you money. Or zeroing your account. Either way, it is going to be fun!</p>
<p>The majority of the examples are going to be in Python even though there might be parts in Erlang and I'll try to keep it as easy as it can be. </p>
<p>Let's talk now about what the final product will look like.</p>
<p>We are building a system where you will be able to:</p>
<ol>
<li>Simulate your strategy (this is called <a href="http://jon.io/building-a-backtesting-system-in-python-or-how-i-lost-3400-in-two-hours.html">backtesting</a>)</li>
<li>Execute your strategy without supervision</li>
<li>Alert you via sms/email for trades and errors</li>
<li>Be scalable and trivial to deploy new updates</li>
<li>Being able to run even from your home (from a raspberrypi for example)</li>
</ol>
<p>I assume this is going to be a total of 20 chapters, give or take.</p>
<p>That is a system similar to the one that I am running the last year and includes a UI, sms alerts, backtesting pipeline, continuous delivery and all the cool stuff that us geeks love.</p>
<p>All code will be on <a href="https://github.com/jonromero/forex_algotrading">github</a> and if everything goes well, I'll wrap it up in a book for everyone to enjoy.</p>
<p>I have like three chapters almost done, so if you want early access just ping me at - <a href="http://www.twitter.com/jonromero">jonromero</a>.</p> </div>
            <div class="abbr published">
                Posted  <a href='../how-to-build-your-own-algorithmic-trading-platform-part-one.html' title='2015-10-01T22:48:00-07:00'>Thu 01 October 2015</a> in <a href="../category/trading.html">trading</a>.              
            </div>
        </article>
        <article class='listed'>
            <h1 class="title">
                <a href="../how-to-build-your-own-algorithmic-trading-platform.html" rel='bookmark'>How to build your own algorithmic trading platform</a>
            </h1>
            <div class="article-content"> <p>These are all the post that have been written up until now. I may add/remove post as I get more feedback. </p>
<!-- Begin MailChimp Signup Form -->

<p><link href="//cdn-images.mailchimp.com/embedcode/classic-081711.css" rel="stylesheet" type="text/css">
<style type="text/css">
    #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
    /<em> Add your own MailChimp form style overrides in your site stylesheet or in this style block.
       We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. </em>/
</style>
<div id="mc_embed_signup">
<form action="//jon.us2.list-manage.com/subscribe/post?u=d41a019257dd51ec51a105e74&amp;id=b1233e19f3" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
    <h2>Get early access and free insights for Algotrading and Forex!</h2>
<div class="indicates-required"><span class="asterisk"><em></span> indicates required</div>
<div class="mc-field-group">
    <label for="mce-EMAIL">Email Address  <span class="asterisk"></em></span>
</label>
    <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
</div>
    <div id="mce-responses" class="clear">
        <div class="response" id="mce-error-response" style="display:none"></div>
        <div class="response" id="mce-success-response" style="display:none"></div>
    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_d41a019257dd51ec51a105e74_b1233e19f3" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>
<script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script><script type='text/javascript'>(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';}(jQuery));var $mcj = jQuery.noConflict(true);</script>
<!--End mc_embed_signup--></p>
<p>Post One: <a href="how-to-build-your-own-algorithmic-trading-platform-part-one.html">Building your own algotrading platform</a></p>
<p>Post Two: <a href="what-is-forex.html">What is Forex</a></p>
<p>Post Three: <a href="placing-your-first-forex-trade-with-python.html">Placing your first trade</a> </p>
<p>Post Four: <a href="http://jon.io/downloading-historical-forex-tick-data-and-importing-them-in-to-python-using-pandas.html">Downloading historical Forex tick data and importing them in to Python</a></p>
<p>Post Five: <a href="http://jon.io/building-a-backtesting-system-in-python-or-how-i-lost-3400-in-two-hours.html">Building a backtesting system in Python: or how I lost $3400 in two hours</a></p>
<p>Post Six: [You don't need to be a scientist to build a backtesting algotrading system in Python](](http://jon.io/backtesting-part-two.html)</p>
<p>Post Seven: <a href="http://jon.io/why-the-irs-loves-forex.html">Why the IRS loves Taxes</a></p>
<p>Post Eight: Winner, winner, chicken, dinner | Building our first algorithm</p>
<p>Post Nine: Forex Psychology | Machines beating humans</p>
<p>Post Ten: Deploy and automate</p>
<p>Post Eleven: Notifications, SMS and remote control</p>
<p>Post Twelve: Deep Learning and kicking (human) ass</p>
<p>Post Thirteen: Forex advanced</p>
<p>Port Fourteen: Into to HFT</p> </div>
            <div class="abbr published">
                Posted  <a href='../how-to-build-your-own-algorithmic-trading-platform.html' title='2015-09-28T22:48:00-07:00'>Mon 28 September 2015</a> in <a href="../category/trading.html">trading</a>.              
            </div>
        </article>
        <article class='listed'>
            <h1 class="title">
                <a href="../mapping-and-processing-data-in-clojure.html" rel='bookmark'>Mapping and processing data in Clojure</a>
            </h1>
            <div class="article-content"> <p>I have to admit that I have a thing for DSLs. You can see it at <a href="https://github.com/jonromero/music-as-data">music-as-data</a> were notes and rhythm/beat is "mapped" to data and you can apply data transformations. </p>
<p>The same thing I want to do with <a href="http://en.wikipedia.org/wiki/Data_at_Rest">data at-rest</a>.</p>
<p>Here is a scenario:
I have lots of data sitting as CSV on my hard-drive and I want to process them. Not query them. Process them.</p>
<p>What would be really interesting is to be able to define (dynamically) a schema like that:</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defschema</span> <span class="s">&quot;EURUSD&quot;</span> 
    <span class="p">(</span><span class="nf">tokenizer</span> <span class="o">#</span><span class="p">(</span><span class="nf">.split</span> <span class="nv">%</span> <span class="s">&quot;:&quot;</span><span class="p">))</span>  
    <span class="c1">;; the mapping is done here</span>
    <span class="p">(</span><span class="nf">columns</span> <span class="err">|</span><span class="nv">time</span><span class="err">|</span> <span class="err">|</span><span class="nv">open</span><span class="err">|</span> <span class="err">|</span><span class="nv">high</span><span class="err">|</span> <span class="err">|</span><span class="nv">low</span><span class="err">|</span> <span class="err">|</span><span class="nv">close</span><span class="err">|</span> <span class="err">|</span><span class="nv">volume</span><span class="err">|</span><span class="p">))</span>
</pre></div>


<p>Let me explain.
First of all, a "tokenize" function. Each dataline is tokenized based on a function. Do you want regex? Something more complex? You are free to write anything you like. I really hate frameworks that you must write a complex regular expression or use a compicated system just to tokenize a line.</p>
<p>As you can imagine, tokenize returns a list of data that are mapped to "columns".</p>
<p>Now, the interesting stuff. </p>
<p>You can write scripts like the following:</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="err">|</span><span class="nv">close</span><span class="err">|</span> <span class="mf">1.45</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">place-order</span> <span class="ss">:buy</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">place-order</span> <span class="ss">:sell</span><span class="p">))</span>
</pre></div>


<p>Thoughts? </p>
<p>ping me here -&gt; <a href="http://www.twitter.com/jonromero">JR</a></p> </div>
            <div class="abbr published">
                Posted  <a href='../mapping-and-processing-data-in-clojure.html' title='2014-11-20T22:48:00-08:00'>Thu 20 November 2014</a> in <a href="../category/databases.html">databases</a>.              
            </div>
        </article>
        <article class='listed'>
            <h1 class="title">
                <a href="../hybrisdb.html" rel='bookmark'>HybrisDB</a>
            </h1>
            <div class="article-content"> <p>I love Forex because:</p>
<ol>
<li>It has enormous amount of data (volume)</li>
<li>These data are coming extremely fast (velocity)</li>
<li>You need to consider multiple resources when you are building your strategy (variety)</li>
</ol>
<p>My definition of BigData is that you have volume-velocity-variety information <strong>and</strong> you need to react on it right now (realtime). It is one of the main reasons why I don't like Hadoop (ok, the other is because I don't like Java:). </p>
<p>Forex is the best place if you want to start playing with BigData. You have (at least) one data channel, hitting you with data, you need to keep running algorithms on this stream (sometimes doing correlations up to a week) and you need be able to respond very fast. If a garbage collector kicks in or if you need to grab data from a database (even if this DB is in memory - long live Redis) then you will have issues.</p>
<p>That's the reason why most of the "trading" databases have all their data in the same memory space and have custom languages doing the analysis (like <a href="http://kx.com">Kdb</a>).</p>
<p>That was the inspiration for LDB.</p>
<p>Millions of data sources (mobile phones), hitting your database and calculating/updating for each one of the requests thousands of counters and running all sorts of algorithms. Per request. In realtime.</p>
<p>But let's face it. The vast majority of users/companies will never have millions (or even thousands) of requests hitting their servers. That's why I started a new opensource database with codename: HybrisDB.</p>
<p>HDB has the following characteristics:</p>
<ol>
<li>Simple to install (no moving parts)</li>
<li>Simple to use (pre-defined dashboards)</li>
<li>It will be perfect for the 99% of users/companies but not for the 1% like Facebook or Google (sacrificing Enterprise features)</li>
</ol>
<p>The concept is to have a dashboard, to watch indicators going on/off and then (maybe) connect to a system to place an order.</p>
<p>Sounds like an interesting cool hobby project and I still try to decide between using Erlang or Clojure for this.</p>
<p>Ping me on <a href="http://www.twitter.com/jonromero">twitter</a> if you have any ideas!</p>
<p>Cheers!</p>
<p>JR</p> </div>
            <div class="abbr published">
                Posted  <a href='../hybrisdb.html' title='2014-10-20T22:48:00-07:00'>Mon 20 October 2014</a> in <a href="../category/databases.html">databases</a>.              
            </div>
        </article>
        <article class='listed'>
            <h1 class="title">
                <a href="../how-to-have-7-more-days-every-month.html" rel='bookmark'>How to have 7 more days every month</a>
            </h1>
            <div class="article-content"> <p>One of my new year's resolution was "study one of your habits each month" and I decided to focus on what activities I am spending my online time. So, I installed <a href="https://www.rescuetime.com/">RescueTime</a> which is a very cool app that sits on the background and creates reports about which apps and sites you are using the most. And no, it is not sending that info to NSA (you are not that important!).</p>
<p>Even though I spent most of my time working, writing and communicating, I also spent around 2 hours on average on Facebook (gasp!). No biggie. What I hated was that for the majority of times I was scrolling/refreshing for new updates.
Like opening your refrigirator every two minutes even though you know it is empty! Damn you habits!</p>
<p>So, spending 2 hours every day (sometimes more) on Facebook, means 60 hours per month or <em>7 working days</em>. 7 freaking working days each month. 7 days, each day with 8 full hours, to sleep, go out, exercise, write a book, learn something new.</p>
<p>What I did was installing <a href="https://chrome.google.com/webstore/detail/stayfocusd/laankejkbhbdhmipfmgcngdelahlfoji">StayFocused</a>, a free plugin for your browser that doesn't let you spent more than 10 minutes on specific sites everyday. And guess what. The "I am just using facebook to communicate" is such a lame excuse as I had no problem communicating with my friends, even by using facebook for 10 minutes.</p>
<p>Now, give it a shot and tell me what you built in your spare time!</p>
<ul>
<li><a href="http://www.twitter.com/jonromero">JR</a></li>
</ul> </div>
            <div class="abbr published">
                Posted  <a href='../how-to-have-7-more-days-every-month.html' title='2013-10-20T22:48:00-07:00'>Sun 20 October 2013</a> in <a href="../category/productivity.html">productivity</a>.              
            </div>
        </article>
    </section>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-12225850-10', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>